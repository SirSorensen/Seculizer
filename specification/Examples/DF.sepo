
Participants: Alice, Bob;
Functions: exp/2;
Knowledge: Alice: X, msgA;
           Bob: Y, msgB;
           Shared: g;
Equations: exp(exp(g,Y),X) = exp(exp(g,X),Y), exp(exp(g,Y),X) = exp(g,X*Y);
Format: exp(x,y) = $x^y$;

Protocol:
A -> B: exp(g,X);
B -> A: exp(g,Y);
A -> B: {MsgA}exp(exp(g,X),Y);
B -> A: {MsgB}exp(exp(g,X),Y);