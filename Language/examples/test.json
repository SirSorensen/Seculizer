{
  "type": "program",
  "participants": {
    "type": "participants",
    "participants": [
      { "type": "participant", "id": "Alice" },
      { "type": "participant", "id": "Bob" }
    ]
  },
  "functions": {
    "type": "functionsDef",
    "functions": [{ "type": "functionDef", "id": "exp", "args": "2" }]
  },
  "equations": {
    "type": "equations",
    "equations": [
      {
        "type": "equation",
        "left": {
          "type": "function",
          "id": "exp",
          "child": {
            "type": "function",
            "id": "exp",
            "child": { "type": "id", "id": "g" }
          }
        },
        "right": {
          "type": "function",
          "id": "exp",
          "child": {
            "type": "function",
            "id": "exp",
            "child": { "type": "id", "id": "g" }
          }
        }
      },
      {
        "type": "equation",
        "left": {
          "type": "function",
          "id": "exp",
          "child": {
            "type": "function",
            "id": "exp",
            "child": { "type": "id", "id": "g" }
          }
        },
        "right": {
          "type": "function",
          "id": "exp",
          "child": {
            "type": "function",
            "id": "exp",
            "child": { "type": "id", "id": "g" }
          }
        }
      }
    ]
  },
  "format": {
    "type": "format",
    "formats": [
      {
        "type": "formatItem",
        "function": {
          "type": "function",
          "id": "exp",
          "child": { "type": "id", "id": "x" }
        },
        "format": { "type": "latex", "value": "$x^y$" }
      }
    ]
  },
  "knowledge": {
    "type": "knowledge",
    "knowledge": [
      {
        "type": "knowledgeItem",
        "id": "Alice",
        "children": {
          "functions": [],
          "ids": [
            { "type": "id", "id": "X" },
            { "type": "id", "id": "msgA" }
          ]
        }
      },
      {
        "type": "knowledgeItem",
        "id": "Bob",
        "children": {
          "functions": [],
          "ids": [
            { "type": "id", "id": "Y" },
            { "type": "id", "id": "msgB" }
          ]
        }
      },
      {
        "type": "knowledgeItem",
        "id": "Shared",
        "children": { "functions": [], "ids": [{ "type": "id", "id": "g" }] }
      }
    ]
  },
  "protocol": {
    "type": "protocol",
    "statements": [
      {
        "type": "statement",
        "child": {
          "type": "sendStatement",
          "leftId": "Alice",
          "rightId": "Bob",
          "child": {
            "type": "messageSendStatement",
            "ids": [
              {
                "type": "messageSendElement",
                "expression": {
                  "type": "expression",
                  "child": {
                    "type": "type",
                    "value": {
                      "type": "function",
                      "id": "exp",
                      "child": { "type": "id", "id": "g" }
                    }
                  }
                },
                "alias": null
              }
            ]
          }
        }
      },
      {
        "type": "statement",
        "child": {
          "type": "sendStatement",
          "leftId": "Bob",
          "rightId": "Alice",
          "child": {
            "type": "messageSendStatement",
            "ids": [
              {
                "type": "messageSendElement",
                "expression": {
                  "type": "expression",
                  "child": {
                    "type": "type",
                    "value": {
                      "type": "function",
                      "id": "exp",
                      "child": { "type": "id", "id": "g" }
                    }
                  }
                },
                "alias": null
              }
            ]
          }
        }
      },
      {
        "type": "statement",
        "child": {
          "type": "sendStatement",
          "leftId": "Alice",
          "rightId": "Bob",
          "child": {
            "type": "messageSendStatement",
            "ids": [
              {
                "type": "messageSendElement",
                "expression": {
                  "type": "expression",
                  "child": {
                    "type": "encryptExpression",
                    "inner": [
                      {
                        "type": "expression",
                        "child": {
                          "type": "type",
                          "value": {
                            "type": "function",
                            "id": "exp",
                            "child": {
                              "type": "function",
                              "id": "exp",
                              "child": { "type": "id", "id": "g" }
                            }
                          }
                        }
                      }
                    ],
                    "outer": {
                      "type": "expression",
                      "child": {
                        "type": "type",
                        "value": { "type": "id", "id": "MsgA" }
                      }
                    }
                  }
                },
                "alias": null
              }
            ]
          }
        }
      },
      {
        "type": "statement",
        "child": {
          "type": "sendStatement",
          "leftId": "Bob",
          "rightId": "Alice",
          "child": {
            "type": "messageSendStatement",
            "ids": [
              {
                "type": "messageSendElement",
                "expression": {
                  "type": "expression",
                  "child": {
                    "type": "encryptExpression",
                    "inner": [
                      {
                        "type": "expression",
                        "child": {
                          "type": "type",
                          "value": {
                            "type": "function",
                            "id": "exp",
                            "child": {
                              "type": "function",
                              "id": "exp",
                              "child": { "type": "id", "id": "g" }
                            }
                          }
                        }
                      }
                    ],
                    "outer": {
                      "type": "expression",
                      "child": {
                        "type": "type",
                        "value": { "type": "id", "id": "MsgB" }
                      }
                    }
                  }
                },
                "alias": null
              }
            ]
          }
        }
      }
    ]
  }
}
